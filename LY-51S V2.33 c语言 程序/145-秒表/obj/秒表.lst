C51 COMPILER V7.06   Ãë_í                                                                  06/07/2010 12:25:05 PAGE 1   


C51 COMPILER V7.06, COMPILATION OF MODULE Ãë_í
OBJECT MODULE PLACED IN .\obj\Ãë±í.obj
COMPILER INVOKED BY: d:\Keil\C51\BIN\C51.EXE Ãë±í.c BROWSE DEBUG OBJECTEXTEND PRINT(.\obj\Ãë±í.lst) OBJECT(.\obj\Ãë±í.ob
                    -j)

stmt level    source

   1          /*-----------------------------------------------
   2            Ãû³Æ£ºÊýÂë¹ÜÏÔÊ¾£¬°´¼ü¿ØÖÆÃë±í
   3            ÂÛÌ³£ºwww.doflye.net
   4            ±àÐ´£ºshifang
   5            ÈÕÆÚ£º2009.5
   6            ÐÞ¸Ä£ºÎÞ
   7            ÄÚÈÝ£ºÖÐ¶Ï°´¼ü¿ØÖÆ£¬ÊýÂë¹ÜÏÔÊ¾
   8          ------------------------------------------------*/
   9          #include<reg52.h> //°üº¬Í·ÎÄ¼þ£¬Ò»°ãÇé¿ö²»ÐèÒª¸Ä¶¯£¬Í·ÎÄ¼þ°üº¬ÌØÊâ¹¦ÄÜ¼Ä´æÆ÷µÄ¶¨Òå
  10          
  11          unsigned int msecond,second;//¶¨ÒåÈ«¾Ö±äÁ¿
  12          bit GoFlag;//¶¨ÒåÍ£Ö¹£¬¼ÆÊ±±êÖ¾
  13          
  14          #define DataPort P0 //¶¨ÒåÊý¾Ý¶Ë¿Ú ³ÌÐòÖÐÓöµ½DataPort ÔòÓÃP0 Ìæ»»
  15          sbit LATCH1=P2^2;//¶¨ÒåËø´æÊ¹ÄÜ¶Ë¿Ú ¶ÎËø´æ
  16          sbit LATCH2=P2^3;//                 Î»Ëø´æ
  17          
  18          unsigned char code dofly_DuanMa[10]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f};// ÏÔÊ¾¶ÎÂëÖµ0~9
  19          unsigned char code dofly_WeiMa[]={0xfe,0xfd,0xfb,0xf7,0xef,0xdf,0xbf,0x7f};//·Ö±ð¶ÔÓ¦ÏàÓ¦µÄÊýÂë¹ÜµãÁÁ,¼´Î»
             -Âë
  20          unsigned char TempData[8]; //´æ´¢ÏÔÊ¾ÖµµÄÈ«¾Ö±äÁ¿
  21          
  22          void DelayUs2x(unsigned char t);//º¯ÊýÉùÃ÷ 
  23          void DelayMs(unsigned char t);
  24          void Display(unsigned char FirstBit,unsigned char Num);
  25          void Init_Timer0(void);
  26          void CLR(void);
  27          /*------------------------------------------------
  28                              Ö÷º¯Êý
  29          ------------------------------------------------*/
  30          void main (void)
  31          {
  32   1      unsigned char num=0;                  
  33   1      
  34   1        
  35   1        EX0=1;         //Íâ²¿ÖÐ¶Ï0¿ª
  36   1        IT0=1;         //IT1=0±íÊ¾±ßÑØ´¥·¢
  37   1        EX1=1;         //Íâ²¿ÖÐ¶Ï1¿ª
  38   1        IT1=1;         //IT1=1±íÊ¾±ßÑØ´¥·¢
  39   1        Init_Timer0();
  40   1      while (1)         //Ö÷Ñ­»·
  41   1        {
  42   2      
  43   2                 TempData[0]=dofly_DuanMa[second/10];//·Ö½âÏÔÊ¾ÐÅÏ¢£¬ÈçÒªÏÔÊ¾68£¬Ôò68/10=6  68%10=8  
  44   2                 TempData[1]=dofly_DuanMa[second%10];
  45   2             TempData[2]=0x40;// "-"
  46   2                 TempData[3]=dofly_DuanMa[msecond/10];//·Ö½âÏÔÊ¾ÐÅÏ¢£¬ÈçÒªÏÔÊ¾68£¬Ôò68/10=6  68%10=8  
  47   2                 TempData[4]=dofly_DuanMa[msecond%10];
  48   2              
  49   2           //Ö÷Ñ­»·ÖÐÌí¼ÓÆäËûÐèÒªÒ»Ö±¹¤×÷µÄ³ÌÐò
  50   2              
  51   2        }
  52   1      }
  53          
C51 COMPILER V7.06   Ãë_í                                                                  06/07/2010 12:25:05 PAGE 2   

  54          /*------------------------------------------------
  55           ÏÔÊ¾º¯Êý£¬ÓÃÓÚ¶¯Ì¬É¨ÃèÊýÂë¹Ü
  56           ÊäÈë²ÎÊý FirstBit ±íÊ¾ÐèÒªÏÔÊ¾µÄµÚÒ»Î»£¬Èç¸³Öµ2±íÊ¾´ÓµÚÈý¸öÊýÂë¹Ü¿ªÊ¼ÏÔÊ¾
  57           ÈçÊäÈë0±íÊ¾´ÓµÚÒ»¸öÏÔÊ¾¡£
  58           Num±íÊ¾ÐèÒªÏÔÊ¾µÄÎ»Êý£¬ÈçÐèÒªÏÔÊ¾99Á½Î»ÊýÖµÔò¸ÃÖµÊäÈë2
  59          ------------------------------------------------*/
  60          void Display(unsigned char FirstBit,unsigned char Num)
  61          {
  62   1            static unsigned char i=0;
  63   1                
  64   1      
  65   1                 DataPort=0;   //Çå¿ÕÊý¾Ý£¬·ÀÖ¹ÓÐ½»ÌæÖØÓ°
  66   1             LATCH1=1;     //¶ÎËø´æ
  67   1             LATCH1=0;
  68   1      
  69   1             DataPort=dofly_WeiMa[i+FirstBit]; //È¡Î»Âë 
  70   1             LATCH2=1;     //Î»Ëø´æ
  71   1             LATCH2=0;
  72   1      
  73   1             DataPort=TempData[i]; //È¡ÏÔÊ¾Êý¾Ý£¬¶ÎÂë
  74   1             LATCH1=1;     //¶ÎËø´æ
  75   1             LATCH1=0;
  76   1             
  77   1                 i++;
  78   1             if(i==Num)
  79   1                    i=0;
  80   1      
  81   1      
  82   1      }
  83          /*------------------------------------------------
  84                              ¶¨Ê±Æ÷³õÊ¼»¯×Ó³ÌÐò
  85          ------------------------------------------------*/
  86          void Init_Timer0(void)
  87          {
  88   1       TMOD |= 0x01;    //Ê¹ÓÃÄ£Ê½1£¬16Î»¶¨Ê±Æ÷£¬Ê¹ÓÃ"|"·ûºÅ¿ÉÒÔÔÚÊ¹ÓÃ¶à¸ö¶¨Ê±Æ÷Ê±²»ÊÜÓ°Ïì                 
  89   1       //TH0=0x00;          //¸ø¶¨³õÖµ
  90   1       //TL0=0x00;
  91   1       EA=1;            //×ÜÖÐ¶Ï´ò¿ª
  92   1       ET0=1;           //¶¨Ê±Æ÷ÖÐ¶Ï´ò¿ª
  93   1       TR0=1;           //¶¨Ê±Æ÷¿ª¹Ø´ò¿ª
  94   1      }
  95          /*------------------------------------------------
  96                           ¶¨Ê±Æ÷ÖÐ¶Ï×Ó³ÌÐò
  97          ------------------------------------------------*/
  98          void Timer0_isr(void) interrupt 1 
  99          {
 100   1       static unsigned char num;
 101   1       TH0=(65536-2000)/256;            //ÖØÐÂ¸³Öµ 2ms
 102   1       TL0=(65536-2000)%256;
 103   1       
 104   1       Display(0,8);
 105   1       if(GoFlag)
 106   1         {
 107   2         num++;
 108   2        if(num==5)
 109   2          {
 110   3              num=0;
 111   3         msecond++;
 112   3         if (msecond==100)//100½ø1
 113   3           {
 114   4           msecond=0;
 115   4           second++;//Ãë¼Ó1
C51 COMPILER V7.06   Ãë_í                                                                  06/07/2010 12:25:05 PAGE 3   

 116   4               if(second==100)
 117   4                 second=0;
 118   4           }
 119   3         }
 120   2        }
 121   1      }
 122          /*------------------------------------------------
 123                        Íâ²¿ÖÐ¶Ï0³ÌÐò
 124          ------------------------------------------------*/
 125          void ISR_INT0(void) interrupt 0 
 126          {
 127   1       GoFlag=!GoFlag; //ÀûÓÃÍâ²¿ÖÐ¶Ï´ò¿ªºÍ¹Ø±Õ¶¨Ê±±êÖ¾ ÓÃÓÚ¿ªÊ¼ºÍÍ£Ö¹¼ÆÊ±
 128   1      }
 129          /*------------------------------------------------
 130                        Íâ²¿ÖÐ¶Ï1³ÌÐò
 131          ------------------------------------------------*/
 132          void ISR_INT1(void) interrupt 2 
 133          {
 134   1      if(GoFlag==0)//Í£Ö¹Ê±²Å¿ÉÒÔÇåÁã
 135   1         CLR();
 136   1      }/*------------------------------------------------
 137                        ÊýÖµÇåÁã
 138          ------------------------------------------------*/
 139          void CLR(void)
 140          {
 141   1       second=0;      //ÀûÓÃÍâ²¿ÖÐ¶ÏÇåÁã
 142   1       msecond=0;
 143   1      }
 144          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    341    ----
   CONSTANT SIZE    =     18    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     14       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
