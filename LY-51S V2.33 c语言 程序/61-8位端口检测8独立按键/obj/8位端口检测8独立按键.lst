C51 COMPILER V7.06   8Î»_Ë¿Ú¼ì²â8_ÀÁ___¼ü                                                  09/10/2012 09:24:50 PAGE 1   


C51 COMPILER V7.06, COMPILATION OF MODULE 8Î»_Ë¿Ú¼ì²â8_ÀÁ___¼ü
OBJECT MODULE PLACED IN .\obj\8Î»¶Ë¿Ú¼ì²â8¶ÀÁ¢°´¼ü.obj
COMPILER INVOKED BY: d:\Keil\C51\BIN\C51.EXE 8Î»¶Ë¿Ú¼ì²â8¶ÀÁ¢°´¼ü.c BROWSE DEBUG OBJECTEXTEND PRINT(.\obj\8Î»¶Ë¿Ú¼ì²â8¶À
                    -Á¢°´¼ü.lst) OBJECT(.\obj\8Î»¶Ë¿Ú¼ì²â8¶ÀÁ¢°´¼ü.obj)

stmt level    source

   1          /*-----------------------------------------------
   2            Ãû³Æ£ºµ¥¸ö¶ÀÁ¢°´¼üÒÀ´ÎÊäÈë¿ØÖÆ
   3            ÂÛÌ³£ºwww.doflye.net
   4            ±àĞ´£ºshifang
   5            ÈÕÆÚ£º2009.5
   6            ĞŞ¸Ä£ºÎŞ
   7            ÄÚÈİ£ºÈç¼ÆËãÆ÷ÊäÈëÊı¾İĞÎÊ½ÏàÍ¬ ´Ó×óÍùÓÒ ÀûÓÃÕû¸ö¶Ë¿ÚÉ¨Ãè¶ÁÈ¡°´¼üÖµ
   8          ------------------------------------------------*/
   9          #include<reg52.h> //°üº¬Í·ÎÄ¼ş£¬Ò»°ãÇé¿ö²»ĞèÒª¸Ä¶¯£¬Í·ÎÄ¼ş°üº¬ÌØÊâ¹¦ÄÜ¼Ä´æÆ÷µÄ¶¨Òå
  10          
  11          #define KeyPort P3
  12          
  13          #define DataPort P0 //¶¨ÒåÊı¾İ¶Ë¿Ú ³ÌĞòÖĞÓöµ½DataPort ÔòÓÃP0 Ìæ»»
  14          sbit LATCH1=P2^2;//¶¨ÒåËø´æÊ¹ÄÜ¶Ë¿Ú ¶ÎËø´æ
  15          sbit LATCH2=P2^3;//                 Î»Ëø´æ
  16          
  17          unsigned char code dofly_DuanMa[10]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f};// ÏÔÊ¾¶ÎÂëÖµ0~9
  18          unsigned char code dofly_WeiMa[]={0xfe,0xfd,0xfb,0xf7,0xef,0xdf,0xbf,0x7f};//·Ö±ğ¶ÔÓ¦ÏàÓ¦µÄÊıÂë¹ÜµãÁÁ,¼´Î»
             -Âë
  19          unsigned char TempData[10]; //´æ´¢ÏÔÊ¾ÖµµÄÈ«¾Ö±äÁ¿
  20          
  21          void DelayUs2x(unsigned char t);//us¼¶ÑÓÊ±º¯ÊıÉùÃ÷ 
  22          void DelayMs(unsigned char t); //ms¼¶ÑÓÊ±
  23          void Display(unsigned char FirstBit,unsigned char Num);//ÊıÂë¹ÜÏÔÊ¾º¯Êı
  24          unsigned char KeyScan(void);//¼üÅÌÉ¨Ãè
  25          void Init_Timer0(void);//¶¨Ê±Æ÷³õÊ¼»¯
  26          /*------------------------------------------------
  27                              Ö÷º¯Êı
  28          ------------------------------------------------*/
  29          void main (void)
  30          {
  31   1      unsigned char num,i,j;                  
  32   1      
  33   1      Init_Timer0();
  34   1      
  35   1      while (1)         //Ö÷Ñ­»·
  36   1        {
  37   2      
  38   2      
  39   2       num=KeyScan();
  40   2       if(num)
  41   2         {
  42   3         if(i<8)
  43   3           TempData[i]=dofly_DuanMa[num];
  44   3              i++;
  45   3              if(i==9)//¶à³öÒ»¸ö°´¼üÊäÈëÎªÁËÇåÆÁ Ô­±¾Ó¦¸ÃÎª8
  46   3                {
  47   4                i=0;
  48   4            for(j=0;j<8;j++)//ÇåÆÁ
  49   4               TempData[j]=0;
  50   4             }
  51   3         }
  52   2        //Display(0,8); //ÏÔÊ¾È«²¿8Î»
  53   2           //Ö÷Ñ­»·ÖĞÌí¼ÓÆäËûĞèÒªÒ»Ö±¹¤×÷µÄ³ÌĞò
C51 COMPILER V7.06   8Î»_Ë¿Ú¼ì²â8_ÀÁ___¼ü                                                  09/10/2012 09:24:50 PAGE 2   

  54   2              
  55   2        }
  56   1      }
  57          /*------------------------------------------------
  58           uSÑÓÊ±º¯Êı£¬º¬ÓĞÊäÈë²ÎÊı unsigned char t£¬ÎŞ·µ»ØÖµ
  59           unsigned char ÊÇ¶¨ÒåÎŞ·ûºÅ×Ö·û±äÁ¿£¬ÆäÖµµÄ·¶Î§ÊÇ
  60           0~255 ÕâÀïÊ¹ÓÃ¾§Õñ12M£¬¾«È·ÑÓÊ±ÇëÊ¹ÓÃ»ã±à,´óÖÂÑÓÊ±
  61           ³¤¶ÈÈçÏÂ T=tx2+5 uS 
  62          ------------------------------------------------*/
  63          void DelayUs2x(unsigned char t)
  64          {   
  65   1       while(--t);
  66   1      }
  67          /*------------------------------------------------
  68           mSÑÓÊ±º¯Êı£¬º¬ÓĞÊäÈë²ÎÊı unsigned char t£¬ÎŞ·µ»ØÖµ
  69           unsigned char ÊÇ¶¨ÒåÎŞ·ûºÅ×Ö·û±äÁ¿£¬ÆäÖµµÄ·¶Î§ÊÇ
  70           0~255 ÕâÀïÊ¹ÓÃ¾§Õñ12M£¬¾«È·ÑÓÊ±ÇëÊ¹ÓÃ»ã±à
  71          ------------------------------------------------*/
  72          void DelayMs(unsigned char t)
  73          {
  74   1           
  75   1       while(t--)
  76   1       {
  77   2           //´óÖÂÑÓÊ±1mS
  78   2           DelayUs2x(245);
  79   2               DelayUs2x(245);
  80   2       }
  81   1      }
  82          /*------------------------------------------------
  83           ÏÔÊ¾º¯Êı£¬ÓÃÓÚ¶¯Ì¬É¨ÃèÊıÂë¹Ü
  84           ÊäÈë²ÎÊı FirstBit ±íÊ¾ĞèÒªÏÔÊ¾µÄµÚÒ»Î»£¬Èç¸³Öµ2±íÊ¾´ÓµÚÈı¸öÊıÂë¹Ü¿ªÊ¼ÏÔÊ¾
  85           ÈçÊäÈë0±íÊ¾´ÓµÚÒ»¸öÏÔÊ¾¡£
  86           Num±íÊ¾ĞèÒªÏÔÊ¾µÄÎ»Êı£¬ÈçĞèÒªÏÔÊ¾99Á½Î»ÊıÖµÔò¸ÃÖµÊäÈë2
  87          ------------------------------------------------*/
  88          void Display(unsigned char FirstBit,unsigned char Num)
  89          {
  90   1            static unsigned char i=0;
  91   1                
  92   1      
  93   1                 DataPort=0;   //Çå¿ÕÊı¾İ£¬·ÀÖ¹ÓĞ½»ÌæÖØÓ°
  94   1             LATCH1=1;     //¶ÎËø´æ
  95   1             LATCH1=0;
  96   1      
  97   1             DataPort=dofly_WeiMa[i+FirstBit]; //È¡Î»Âë 
  98   1             LATCH2=1;     //Î»Ëø´æ
  99   1             LATCH2=0;
 100   1      
 101   1             DataPort=TempData[i]; //È¡ÏÔÊ¾Êı¾İ£¬¶ÎÂë
 102   1             LATCH1=1;     //¶ÎËø´æ
 103   1             LATCH1=0;
 104   1             
 105   1                 i++;
 106   1             if(i==Num)
 107   1                    i=0;
 108   1      
 109   1      
 110   1      }
 111          /*------------------------------------------------
 112                              ¶¨Ê±Æ÷³õÊ¼»¯×Ó³ÌĞò
 113          ------------------------------------------------*/
 114          void Init_Timer0(void)
 115          {
C51 COMPILER V7.06   8Î»_Ë¿Ú¼ì²â8_ÀÁ___¼ü                                                  09/10/2012 09:24:50 PAGE 3   

 116   1       TMOD |= 0x01;    //Ê¹ÓÃÄ£Ê½1£¬16Î»¶¨Ê±Æ÷£¬Ê¹ÓÃ"|"·ûºÅ¿ÉÒÔÔÚÊ¹ÓÃ¶à¸ö¶¨Ê±Æ÷Ê±²»ÊÜÓ°Ïì                 
 117   1       //TH0=0x00;          //¸ø¶¨³õÖµ
 118   1       //TL0=0x00;
 119   1       EA=1;            //×ÜÖĞ¶Ï´ò¿ª
 120   1       ET0=1;           //¶¨Ê±Æ÷ÖĞ¶Ï´ò¿ª
 121   1       TR0=1;           //¶¨Ê±Æ÷¿ª¹Ø´ò¿ª
 122   1      }
 123          /*------------------------------------------------
 124                           ¶¨Ê±Æ÷ÖĞ¶Ï×Ó³ÌĞò
 125          ------------------------------------------------*/
 126          void Timer0_isr(void) interrupt 1 
 127          {
 128   1       TH0=(65536-2000)/256;            //ÖØĞÂ¸³Öµ 2ms
 129   1       TL0=(65536-2000)%256;
 130   1       
 131   1       Display(0,8);       // µ÷ÓÃÊıÂë¹ÜÉ¨Ãè
 132   1      
 133   1      }
 134          
 135          /*------------------------------------------------
 136                    °´¼üÉ¨Ãèº¯Êı£¬·µ»ØÉ¨Ãè¼üÖµ
 137          ------------------------------------------------*/
 138          unsigned char KeyScan(void)
 139          {
 140   1       unsigned char keyvalue;
 141   1       if(KeyPort!=0xff)
 142   1         {
 143   2          DelayMs(10);
 144   2          if(KeyPort!=0xff)
 145   2                 {
 146   3                  keyvalue=KeyPort;
 147   3                  while(KeyPort!=0xff);
 148   3                      switch(keyvalue)
 149   3                      {
 150   4                       case 0xfe:return 1;break;
 151   4                       case 0xfd:return 2;break;
 152   4                       case 0xfb:return 3;break;
 153   4                       case 0xf7:return 4;break;
 154   4                       case 0xef:return 5;break;
 155   4                       case 0xdf:return 6;break;
 156   4                       case 0xbf:return 7;break;
 157   4                       case 0x7f:return 8;break;
 158   4                       default:return 0;break;
 159   4                      }
 160   3                }
 161   2         }
 162   1         return 0;
 163   1      }
 164          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    265    ----
   CONSTANT SIZE    =     18    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     11       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
